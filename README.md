# continuous-grid-arctic
A continuous environment for reinforcement learning of the task of the following the leader

## Репозиторий для решения задачи следования в данной среде методами обучения с подкреплением
Ссылка на репозиторий: https://github.com/gilmoright/RL_robotSim.

В репозитории представлена подробная инструкция по использованию и настройки данной среды для обучения агента для 
задачи следования методами обучения с подкреплением


### Краткая инструкция:
Пример работы среды в скрипте main.py:
>> python main.py

Имеет следующие аргументы командной строки:
* флаг manual -- если указан, управление агентом проводится вручную, с помощью стрелок;
* n_steps -- число шагов среды, в течение которых проводится проверочная симуляция (по умолчанию: 5000);
* training_steps -- в случае автоматического режима работы - число шагов, в течение которых учится модель.

На данный момент одна симуляция длится не более 5000 шагов (задаётся при создании конкретной среды параметром max_steps) или до тех пор, пока агент не попадёт в аварию (что наступит раньше)
При создании среды можно задавать дополнительные ограничения;

### Конфигурация среды
Чтобы создать свою версию среды: 
1. в файле follow_the_leader_continuous_env.py создать наследующий основную среду класс (как, например, Test-Cont-Env-Auto-v0);
2. в методе init созданного класса задать нужные параметры при инициализации родительского класса (полный список параметров смотреть в методе init класса Game);
3. "зарегистрировать" среду как среду gym с помощью gym_register, по следующему шаблону:

    3.1. id=Test-Cont-Env-<собственное_название>-v0;
    
    3.2. follow_the_leader_continuous_env:<название класса среды, который создан в п.1>;
    
    3.3. reward_threshold по своему желанию.

### Описание сенсоров
В среде реализовано некоторое количество сенсоров для взаимодействия робота с миром
#### Основные:
   - **LeaderPositionsTracker_v2** - (основной) сенсор позволяющий считывать положения ведущего и на основе этой информации хранит
историю точек маршрута ведущего определенный длинны и настраиваемый коридор следования
   - LeaderCorridor_lasers - "лучевой сенсор" с 7 лучами (baseline), входные признаки для нейросетевой модели на основе измерения информации о
расстояние до препятствий и коридора
   - LeaderCorridor_lasers_v2 - "лучевой сенсор" с настраиваемым количеством лучей (12 в базовой конфигурации) реагирующий
на коридор и препятствия
   - LeaderObstacles_lasers - "лучевой сенсор" с настраиваемым количеством лучей, реагирующий только на препятствия 
(двух типов: статических и динамических)
   - **LeaderCorridor_Prev_lasers_v2** - (основной) "лучевой сенсор" с возможностью сохранять информацию о препятствиях на предыдущих 
шагах. Данная информация позволяет хранить информацию о значениях лучей на предыдущих шагах с учетом пересчета этих значений 
относительно текущего положения робота на каждом новом шаге. Имеет настраиваемые значения лучей и длинны истории. Определяет
ближайшее расстояние до препятствия или коридора следования. 
   - **LaserPrevSensor** - (основной) "лучевой сенсор", аналогичен LeaderCorridor_Prev_lasers_v2. Однако, определяет ближайшее расстояние 
только до препятствий.

#### Устаревшие:
   - LaserSensor - "признаки лидара"
   - LeaderPositionsTracker - сенсор для формирования истории точек маршрута лидера (устаревший вариант)
   - LeaderTrackDetector_vector - сенсор для определения истории точек маршрута лидера (не используется)
   - LeaderTrackDetector_radar - сенсор для определения сектора, в котором находится история маршрута ведущего (первый 
baseline)
   - GreenBoxBorderSensor - сенсор определения зоны безопасности...?
   - Leader_Dyn_Obstacles_lasers - "лучевой сенсор" по определению расстояния только до динамических препятствий
   - FollowerInfo - сенсор для формирования входных признаков с информаций о линейной и угловой скорости робота

### TODO:

- [ ] сигнал "стоп";
- [ ] фабрика-конфигуратор сред;
- [ ] конфигурации роботов;
- [ ] конфигуратор получаемых от среды наблюдений;
- [X] лидары на роботах;
- [X] генерация препятствий (особенно мостов!);
- [X] генерация маршрута Ведущего с учётом препятствий;
- [X] управление Ведущим с учётом препятствий;
- [X] вынесение логики из метода show_tick();
- [X] дополнительная декомпозиция метода step;
- [ ] аварии, при которых происходит столкновение, но не конец симуляции;
- [ ] при тестировании модели управление Ведущим с клавиатуры.
